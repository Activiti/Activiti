
import java.text.SimpleDateFormat;
import java.util.Date;

def getDateTime() {
		SimpleDateFormat format = new SimpleDateFormat("yyyyMMdd-HHmm");
		return format.format(new Date());
}


buildscript {

    ext {
    		projectVersion = '6.0.0'
			activitiVersion = '6.0.0'
			springVersion = '4.1.6.RELEASE '
			springSecurityVersion = '4.0.1.RELEASE'
			hibernateVersion = '4.2.16.Final'
			jacksonVersion = '2.3.3'
			codahaleMetricsVersion = '3.0.2'
			hazelcastcacheVersion = '3.1.5'
			batikVersion = '1.7'
			jettyVersion = '9.1.3.v20140225'

    }
	
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.5.3.RELEASE")
    }
}



allprojects {
	apply plugin: 'java'
	apply plugin: 'eclipse'
	apply plugin: 'org.springframework.boot'
	
	
  eclipse {
    classpath {
  
    }
  }
}

subprojects {
	apply plugin: 'java'
	apply plugin: 'eclipse'


	sourceCompatibility = 1.8
	targetCompatibility = 1.8

	ext {
		currentTime = getDateTime()
	}

	tasks.withType(JavaCompile) {
		options.encoding = "UTF-8"
	}
	
	repositories {
		maven { url 'http://maven.aliyun.com/nexus/content/repositories/central/' }
		maven { url "http://www.datanucleus.org/downloads/maven2" }
		maven { url 'http://maven.ibiblio.org/maven2/' }
	    maven { url "https://repository.jboss.org/nexus/content/repositories/releases" }
	    mavenCentral()
	    
	}

}


project(':activiti-app-conf') {
	apply plugin: 'war'
	
 	dependencies {
 		compile project(":activiti-app-logic")
 		compile project(":activiti-app-rest")
 		compile project(":content-storage-api")
 		compile project(":content-storage-fs")
 		compile project(":editor-image-generator")
 	}

}

project(':activiti-app-logic') {
	

 	dependencies {

 		compile project(":content-storage-api")
 		compile project(":content-storage-fs")
 		compile project(":editor-image-generator")

 	}

}

project(':activiti-app-rest') {
 	dependencies {
 		compile	project(":activiti-app-logic")
 		compile project(":content-storage-api")
 		compile project(":content-storage-fs")
 		compile project(":editor-image-generator")

 	}

}

project(':content-storage-api') {
 	dependencies {

 	}

}

project(':content-storage-fs') {
 	dependencies {
 
 	}

}

project(':editor-image-generator') {
	dependencies {

		compile("org.activiti:activiti-ui-root:${projectVersion}")

		compile("org.activiti:content-storage-api:${projectVersion}")
		compile("org.activiti:content-storage-fs:${projectVersion}")
		compile("org.activiti:activiti-app-logic:${projectVersion}")
		compile("org.activiti:activiti-app-rest:${projectVersion}")
		compile("org.activiti:activiti-app-conf:${projectVersion}")
		compile("org.activiti:editor-image-generator:${projectVersion}")

		////  Activiti Enterprise Engine 
		compile("org.activiti:activiti-engine:${activitiVersion}")
		compile("org.activiti:activiti-spring:${activitiVersion}")
		compile("org.activiti:activiti-bpmn-model:${activitiVersion}")
		compile("org.activiti:activiti-bpmn-converter:${activitiVersion}")
		compile("org.activiti:activiti-json-converter:${activitiVersion}")
		compile("org.activiti:activiti-process-validation:${activitiVersion}")
		compile("org.activiti:activiti-bpmn-layout:${activitiVersion}")
		compile("org.activiti:activiti-form-engine-configurator:${activitiVersion}")
		compile("org.activiti:activiti-form-engine:${activitiVersion}")
		compile("org.activiti:activiti-form-model:${activitiVersion}")
		compile("org.activiti:activiti-form-json-converter:${activitiVersion}")
		compile("org.activiti:activiti-image-generator:${activitiVersion}")
		compile("org.activiti:activiti-rest:${activitiVersion}")

		////  Xerces is needed (eg by jboss, which ships with an old version), for process definition parsing 
		compile("xerces:xercesImpl:2.11.0")


		////  LOGGING 
		compile("org.slf4j:slf4j-api:1.7.5")
		compile("org.slf4j:slf4j-log4j12:1.7.5")
		compile("org.slf4j:jcl-over-slf4j:1.7.5")

		////  JSON 
		compile("com.fasterxml.jackson.core:jackson-core:${jacksonVersion}")
		compile("com.fasterxml.jackson.core:jackson-databind:${jacksonVersion}")
		compile("com.fasterxml.jackson.core:jackson-annotations:${jacksonVersion}")
		compile("com.fasterxml.jackson.datatype:jackson-datatype-json-org:${jacksonVersion}")
		compile("com.fasterxml.jackson.datatype:jackson-datatype-hppc:${jacksonVersion}")
		compile("com.fasterxml.jackson.datatype:jackson-datatype-joda:${jacksonVersion}")

		////  DATABASE 
		compile("org.liquibase:liquibase-core:3.1.0")
		compile("com.mchange:c3p0:0.9.2.1")
		compile("org.hsqldb:hsqldb:2.3.1")
		compile("mysql:mysql-connector-java:5.1.30")
		compile("org.hibernate:hibernate-core:${hibernateVersion}")
		compile("org.hibernate:hibernate-entitymanager:${hibernateVersion}")
		compile("org.hibernate:hibernate-validator:5.0.2.Final")


		////  COMMON dependencies 
		compile("commons-fileupload:commons-fileupload:1.3")
		compile("commons-io:commons-io:2.4")
		compile("org.apache.commons:commons-lang3:3.3.2")
		compile("commons-codec:commons-codec:1.9")
		compile("com.google.guava:guava:17.0")
		compile("javax.annotation:jsr250-api:1.0")
		compile("javax.inject:javax.inject:1")
		compile("javax.servlet:javax.servlet-api:3.1.0")
		<scope>provided</scope

		compile("javax.servlet:jstl:1.2")
		compile("javax.validation:validation-api:1.1.0.Final")

		////  JODA TIME 
		compile("joda-time:joda-time:2.3")
		compile("joda-time:joda-time-hibernate:1.3")
		compile("org.jadira.usertype:usertype.core:3.1.0.CR10")

		////  SPRING 
		compile("org.aspectj:aspectjweaver:1.7.4")
		compile("org.springframework:spring-aop:${springVersion}")
		compile("org.springframework:spring-beans:${springVersion}")
		compile("org.springframework:spring-context:${springVersion}")
		compile("org.springframework:spring-context-support:${springVersion}")
		compile("org.springframework:spring-core:${springVersion}")
		compile("org.springframework:spring-expression:${springVersion}")
		compile("org.springframework:spring-orm:${springVersion}")
		compile("org.springframework:spring-tx:${springVersion}")
		compile("org.springframework:spring-web:${springVersion}")
		compile("org.springframework:spring-webmvc:${springVersion}")
		compile("org.springframework.data:spring-data-jpa:1.7.1.RELEASE")
		compile("org.springframework.security:spring-security-core:${springSecurityVersion}")
		compile("org.springframework.security:spring-security-config:${springSecurityVersion}")
		compile("org.springframework.security:spring-security-crypto:${springSecurityVersion}")
		compile("org.springframework.security:spring-security-web:${springSecurityVersion}")
		compile("org.springframework.security:spring-security-ldap:${springSecurityVersion}")

		////  EMAIL 
		compile("org.freemarker:freemarker:2.3.20")
		compile("javax.mail:mail:1.4.7")
		compile("commons-validator:commons-validator:1.4.0")

		////  Groovy needed for embedded scripting 
		compile("org.codehaus.groovy:groovy-all:2.3.5")

		////  HTTPCLIENT 
		compile("org.apache.httpcomponents:httpclient:4.3.2"

		////  TEST
		testCompile("junit:junit:4.11")
		testCompile("com.jayway.jsonpath:json-path:1.2.0")
		testCompile("org.hamcrest:hamcrest-core:1.3")
		testCompile("org.hamcrest:hamcrest-library:1.3")
		testCompile("org.mockito:mockito-all:1.9.5")
		testCompile("org.springframework:spring-test:${springVersion}")
		testCompile("org.eclipse.jetty:jetty-webapp:${jettyVersion}")
		testCompile("org.apache.httpcomponents:httpmime:4.3.5")

	}
}



project(':activiti-app') {
	apply plugin: 'java'
	apply plugin: 'war'
	apply plugin: 'eclipse-wtp'
	
	
	jar {
	    baseName = 'activiti-app'  
	    version =  '6.0.0-' + currentTime
	}
	
	dependencies {

		compile project(":activiti-app-conf") 
		//compile("org.springframework.boot:spring-boot-starter-web")
		compile("mysql:mysql-connector-java:5.1.43")
		compile("com.h2database:h2:1.4.194")
	}
}


project(':activiti-ui') {
	
	dependencies {
		compile project(":activiti-app-rest")
		compile	project(":activiti-app-logic")
 		compile project(":content-storage-api")
 		compile project(":content-storage-fs")
 		compile project(":editor-image-generator")
		compile project(":activiti-app-conf") 
		compile project(':activiti-app')
	}
}

 
 
